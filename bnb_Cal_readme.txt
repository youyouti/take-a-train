2018/6/9
bnb_Calenderシステム

１．システム概要

　　このシステムは、AirBNBのListing画面から、予約状況をを取得し、データベースに納めます。
　　システムを構成するファイルは下記の通りです。
　　プログラムはこれらのファイル（MySQLを除く）が同一フォルダーに存在することを前提としています。
 
　　bnb_Calender_v2.5.py
	pythonプログラム
	本体プログラムモジュールです。

　　bnb_Cal.py
	プログラムライブラリーモジュールです。
	AirBNBのListing画面とのインターフェースを担当します。
	
　　pydoSQL.py
	プログラムライブラリーモジュールです。
	MySQLとのやり取りを行います。
	（bnb-Listingシステムと共通です）


　　bnb_Calender_init.txt
	プログラム実行上、必要なパラメータを設定するファイルです。
	以下に記述する各ファイルのファイル名は、このファイルに記述することにより、変更できます。

　　bnb-Listing-table_def.txt
　　	データベース定義ファイル
	データベースへの接続のための情報および入力テーブルのカラム定義を記述します。
	（bnb-Listingシステムと共通です）

　　bnb_Calender_table_def.txt
	データベース定義ファイル
	データベースへの接続のための情報および出力テーブルのカラム定義を記述します。

　　bnb_Cal_holiday.txt
	祝日ファイル
	出力データの祝日のカラムに書き込むため、祝日をリストします。
	
　　bnb_Calender_out.txt
	検索結果を書き出す一時的なファイルです。
	検索の一区切りごとに、データベースへの一括書き込みが行われます。

　　bnb-Cal-readme.txt
	説明用ファイル(個のファイル)です。

　　MySQLデータベースファイル
	Listing　ID　のファイル　＝　入力テーブル


２．使用手順

	１）使用環境を構築します
		MySQL、Python 、Selenium　が必要です。
		MySQLについてはInstallの時点ではPathの設定がされていない場合があり、
		その場合はPathの設定をする必要があります。

	２）MySQLを起動してデータベースを作成します。
		言わばデータベースの名前を登録するというほどの手続きです。

	３）設定用各.txtファイルを作成します。

	４）bnb_Calender_vx.x.py　を実行します。
		
３．initファイル
	空白行で区切られた複数のブロックで構成します。
	（空白部分の行数は任意です。ブロック内では空白行を置かないルールです）

	第1ブロックはコメントです。

	第2、第3ブロックに記述されるデータがプログラムによって使用されます。
	各行内のデータはタブによって区切り、第2番目のデータがプログラムによって読まれます。
	3番目のデータとして、ダミーを入力しておいてください。
	プログラムは各設定値をブロック内の行位置によって識別します。

	第3ブロック以降は無視されます。

４．データベース定義ファイル

	空白行で区切られた複数のブロックで構成します。
	（空白部分の行数は任意です。ブロック内では空白行を置かないルールです）

	第1ブロックでは、データーベースを指定します。
	項目名に続く'='のあとに、値を記入します。
	とくに、データベース名とパスワードはユーザー固有のものを書き入れていただく必要があります。

	第2ブロックでは、テーブル名およびカラム定義を記述します。
	テーブル名は最初の行の、項目名に続くtabの後に記述します。
	カラム定義は1カラムにつき1行で、番号、カラム名、データ型、桁数を
	タブで区切って記述します。
	（エクセルの表をコピペするとこの形になります）

	なお、カラム定義は、次の条件に従うものとします。
	a)最後から2番目のカラムは　updated_at（データ（行）の更新日時）、TimeStamp型とする。
	b)これより前のカラムにはTimeStamp型を指定しない。
	c)最後のカラムは　created_at（行の新規作成日時）、　TimeStamp型とし、
	  DEFAULT CURRENT_TIMESTAMPを記述しておく。
	これら2個のカラムは、プログラムから書き込みを行いません。

	最後から3番目のカラムにvarchar型を指定すると、場合によって　'data truncated' 警告が出るとともに、
	このカラムが書き込まれない場合もあります。
	原因は究明できておりませんが、varchar型を避け、var型にしておく必要があります。

　　　　



 
